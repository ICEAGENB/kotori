<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>上下文 | Kotori</title>
    <meta name="description" content="Cross-platform chatbot framework base on Node.js and TypeScript">
    <meta name="generator" content="VitePress v1.2.3">
    <link rel="preload stylesheet" href="/assets/style.SKWQbPni.css" as="style">
    
    <script type="module" src="/assets/app.B269FYS0.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/framework.DjBSxm0c.js">
    <link rel="modulepreload" href="/assets/chunks/theme.BiFFgi_Q.js">
    <link rel="modulepreload" href="/assets/guide_modules_context.md.DTI_fXSu.lean.js">
    <link rel="icon" href="/favicon.svg">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-NES42R3BKE"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-NES42R3BKE");</script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-9e9cf943><!--[--><!--]--><!--[--><span tabindex="-1" data-v-467d3fde></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-467d3fde> Skip to content </a><!--]--><!----><header class="VPNav" data-v-9e9cf943 data-v-6e9ed02a><div class="VPNavBar has-sidebar top" data-v-6e9ed02a data-v-7f062c43><div class="wrapper" data-v-7f062c43><div class="container" data-v-7f062c43><div class="title" data-v-7f062c43><div class="VPNavBarTitle has-sidebar" data-v-7f062c43 data-v-2aa99d07><a class="title" href="/" data-v-2aa99d07><!--[--><!--]--><!--[--><img class="VPImage logo" src="/favicon.svg" alt data-v-4d716b12><!--]--><span data-v-2aa99d07>Kotori</span><!--[--><!--]--></a></div></div><div class="content" data-v-7f062c43><div class="content-body" data-v-7f062c43><!--[--><!--]--><div class="VPNavBarSearch search" data-v-7f062c43><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-7f062c43 data-v-586bb2e4><span id="main-nav-aria-label" class="visually-hidden" data-v-586bb2e4>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/basic/" tabindex="0" data-v-586bb2e4 data-v-676c6fe1><!--[--><span data-v-676c6fe1>入门</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/guide/" tabindex="0" data-v-586bb2e4 data-v-676c6fe1><!--[--><span data-v-676c6fe1>开发</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/api/" tabindex="0" data-v-586bb2e4 data-v-676c6fe1><!--[--><span data-v-676c6fe1>接口</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/modules/" tabindex="0" data-v-586bb2e4 data-v-676c6fe1><!--[--><span data-v-676c6fe1>模块中心</span><!--]--></a><!--]--><!--[--><a class="VPLink link vp-external-link-icon VPNavBarMenuLink" href="https://github.com/kotorijs/kotori/blob/master/CHANGELOG.md" target="_blank" rel="noreferrer" tabindex="0" data-v-586bb2e4 data-v-676c6fe1><!--[--><span data-v-676c6fe1>更新日志</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-7f062c43 data-v-98a4376c><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="切换到深色模式" aria-checked="false" data-v-98a4376c data-v-f89deaee data-v-a6627555><span class="check" data-v-a6627555><span class="icon" data-v-a6627555><!--[--><span class="vpi-sun sun" data-v-f89deaee></span><span class="vpi-moon moon" data-v-f89deaee></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-7f062c43 data-v-9b0ab8c3 data-v-69649923><!--[--><a class="VPSocialLink no-icon" href="https://github.com/kotorijs/kotori" aria-label="github" target="_blank" rel="noopener" data-v-69649923 data-v-fe03291a><span class="vpi-social-github" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-7f062c43 data-v-ffd13770 data-v-3f44c8cc><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-3f44c8cc><span class="vpi-more-horizontal icon" data-v-3f44c8cc></span></button><div class="menu" data-v-3f44c8cc><div class="VPMenu" data-v-3f44c8cc data-v-2d4b1320><!----><!--[--><!--[--><!----><div class="group" data-v-ffd13770><div class="item appearance" data-v-ffd13770><p class="label" data-v-ffd13770>主题</p><div class="appearance-action" data-v-ffd13770><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="切换到深色模式" aria-checked="false" data-v-ffd13770 data-v-f89deaee data-v-a6627555><span class="check" data-v-a6627555><span class="icon" data-v-a6627555><!--[--><span class="vpi-sun sun" data-v-f89deaee></span><span class="vpi-moon moon" data-v-f89deaee></span><!--]--></span></span></button></div></div></div><div class="group" data-v-ffd13770><div class="item social-links" data-v-ffd13770><div class="VPSocialLinks social-links-list" data-v-ffd13770 data-v-69649923><!--[--><a class="VPSocialLink no-icon" href="https://github.com/kotorijs/kotori" aria-label="github" target="_blank" rel="noopener" data-v-69649923 data-v-fe03291a><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-7f062c43 data-v-c06b41cc><span class="container" data-v-c06b41cc><span class="top" data-v-c06b41cc></span><span class="middle" data-v-c06b41cc></span><span class="bottom" data-v-c06b41cc></span></span></button></div></div></div></div><div class="divider" data-v-7f062c43><div class="divider-line" data-v-7f062c43></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-9e9cf943 data-v-d2a074b3><div class="container" data-v-d2a074b3><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-d2a074b3><span class="vpi-align-left menu-icon" data-v-d2a074b3></span><span class="menu-text" data-v-d2a074b3>菜单</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-d2a074b3 data-v-b0816357><button data-v-b0816357>返回顶部</button><!----></div></div></div><aside class="VPSidebar" data-v-9e9cf943 data-v-13718d89><div class="curtain" data-v-13718d89></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-13718d89><span class="visually-hidden" id="sidebar-aria-label" data-v-13718d89> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-13718d89><section class="VPSidebarItem level-0" data-v-13718d89 data-v-a043bd0f><!----><div class="items" data-v-a043bd0f><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a043bd0f data-v-a043bd0f><div class="item" data-v-a043bd0f><div class="indicator" data-v-a043bd0f></div><a class="VPLink link link" href="/guide/" data-v-a043bd0f><!--[--><p class="text" data-v-a043bd0f>前言</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-13718d89><section class="VPSidebarItem level-0" data-v-13718d89 data-v-a043bd0f><div class="item" role="button" tabindex="0" data-v-a043bd0f><div class="indicator" data-v-a043bd0f></div><h2 class="text" data-v-a043bd0f>准备流程</h2><!----></div><div class="items" data-v-a043bd0f><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a043bd0f data-v-a043bd0f><div class="item" data-v-a043bd0f><div class="indicator" data-v-a043bd0f></div><a class="VPLink link link" href="/guide/start/environment.html" data-v-a043bd0f><!--[--><p class="text" data-v-a043bd0f>环境搭建</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a043bd0f data-v-a043bd0f><div class="item" data-v-a043bd0f><div class="indicator" data-v-a043bd0f></div><a class="VPLink link link" href="/guide/start/setup.html" data-v-a043bd0f><!--[--><p class="text" data-v-a043bd0f>项目构建</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a043bd0f data-v-a043bd0f><div class="item" data-v-a043bd0f><div class="indicator" data-v-a043bd0f></div><a class="VPLink link link" href="/guide/start/publish.html" data-v-a043bd0f><!--[--><p class="text" data-v-a043bd0f>模块发布</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-13718d89><section class="VPSidebarItem level-0" data-v-13718d89 data-v-a043bd0f><div class="item" role="button" tabindex="0" data-v-a043bd0f><div class="indicator" data-v-a043bd0f></div><h2 class="text" data-v-a043bd0f>基础设施</h2><!----></div><div class="items" data-v-a043bd0f><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a043bd0f data-v-a043bd0f><div class="item" data-v-a043bd0f><div class="indicator" data-v-a043bd0f></div><a class="VPLink link link" href="/guide/base/events.html" data-v-a043bd0f><!--[--><p class="text" data-v-a043bd0f>事件系统（Events）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a043bd0f data-v-a043bd0f><div class="item" data-v-a043bd0f><div class="indicator" data-v-a043bd0f></div><a class="VPLink link link" href="/guide/base/command.html" data-v-a043bd0f><!--[--><p class="text" data-v-a043bd0f>指令注册（Command）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a043bd0f data-v-a043bd0f><div class="item" data-v-a043bd0f><div class="indicator" data-v-a043bd0f></div><a class="VPLink link link" href="/guide/base/middleware.html" data-v-a043bd0f><!--[--><p class="text" data-v-a043bd0f>中间件（Middleware）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a043bd0f data-v-a043bd0f><div class="item" data-v-a043bd0f><div class="indicator" data-v-a043bd0f></div><a class="VPLink link link" href="/guide/base/regexp.html" data-v-a043bd0f><!--[--><p class="text" data-v-a043bd0f>正则匹配（RegExp）</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-13718d89><section class="VPSidebarItem level-0 has-active" data-v-13718d89 data-v-a043bd0f><div class="item" role="button" tabindex="0" data-v-a043bd0f><div class="indicator" data-v-a043bd0f></div><h2 class="text" data-v-a043bd0f>模块化</h2><!----></div><div class="items" data-v-a043bd0f><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a043bd0f data-v-a043bd0f><div class="item" data-v-a043bd0f><div class="indicator" data-v-a043bd0f></div><a class="VPLink link link" href="/guide/modules/plugin.html" data-v-a043bd0f><!--[--><p class="text" data-v-a043bd0f>插件范式（Plugin）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a043bd0f data-v-a043bd0f><div class="item" data-v-a043bd0f><div class="indicator" data-v-a043bd0f></div><a class="VPLink link link" href="/guide/modules/context.html" data-v-a043bd0f><!--[--><p class="text" data-v-a043bd0f>上下文（Context）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a043bd0f data-v-a043bd0f><div class="item" data-v-a043bd0f><div class="indicator" data-v-a043bd0f></div><a class="VPLink link link" href="/guide/modules/schema.html" data-v-a043bd0f><!--[--><p class="text" data-v-a043bd0f>配置检测（Schema）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a043bd0f data-v-a043bd0f><div class="item" data-v-a043bd0f><div class="indicator" data-v-a043bd0f></div><a class="VPLink link link" href="/guide/modules/i18n.html" data-v-a043bd0f><!--[--><p class="text" data-v-a043bd0f>国际化（i18n）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a043bd0f data-v-a043bd0f><div class="item" data-v-a043bd0f><div class="indicator" data-v-a043bd0f></div><a class="VPLink link link" href="/guide/modules/service.html" data-v-a043bd0f><!--[--><p class="text" data-v-a043bd0f>服务依赖（Service）</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-13718d89><section class="VPSidebarItem level-0" data-v-13718d89 data-v-a043bd0f><div class="item" role="button" tabindex="0" data-v-a043bd0f><div class="indicator" data-v-a043bd0f></div><h2 class="text" data-v-a043bd0f>组件化</h2><!----></div><div class="items" data-v-a043bd0f><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a043bd0f data-v-a043bd0f><div class="item" data-v-a043bd0f><div class="indicator" data-v-a043bd0f></div><a class="VPLink link link" href="/guide/adapter/elements.html" data-v-a043bd0f><!--[--><p class="text" data-v-a043bd0f>实现元素类（Elements）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a043bd0f data-v-a043bd0f><div class="item" data-v-a043bd0f><div class="indicator" data-v-a043bd0f></div><a class="VPLink link link" href="/guide/adapter/api.html" data-v-a043bd0f><!--[--><p class="text" data-v-a043bd0f>实现接口类（Api）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a043bd0f data-v-a043bd0f><div class="item" data-v-a043bd0f><div class="indicator" data-v-a043bd0f></div><a class="VPLink link link" href="/guide/adapter/adapter.html" data-v-a043bd0f><!--[--><p class="text" data-v-a043bd0f>实现适配器类（Adapter）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a043bd0f data-v-a043bd0f><div class="item" data-v-a043bd0f><div class="indicator" data-v-a043bd0f></div><a class="VPLink link link" href="/guide/adapter/custom.html" data-v-a043bd0f><!--[--><p class="text" data-v-a043bd0f>自定义服务（Service）</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-13718d89><section class="VPSidebarItem level-0" data-v-13718d89 data-v-a043bd0f><div class="item" role="button" tabindex="0" data-v-a043bd0f><div class="indicator" data-v-a043bd0f></div><h2 class="text" data-v-a043bd0f>扩展功能</h2><!----></div><div class="items" data-v-a043bd0f><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a043bd0f data-v-a043bd0f><div class="item" data-v-a043bd0f><div class="indicator" data-v-a043bd0f></div><a class="VPLink link link" href="/guide/extend/tools.html" data-v-a043bd0f><!--[--><p class="text" data-v-a043bd0f>工具类</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-9e9cf943 data-v-69776346><div class="VPDoc has-sidebar has-aside" data-v-69776346 data-v-104e4e4a><!--[--><!--]--><div class="container" data-v-104e4e4a><div class="aside" data-v-104e4e4a><div class="aside-curtain" data-v-104e4e4a></div><div class="aside-container" data-v-104e4e4a><div class="aside-content" data-v-104e4e4a><div class="VPDocAside" data-v-104e4e4a data-v-de19328b><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-de19328b data-v-7cb1dbce><div class="content" data-v-7cb1dbce><div class="outline-marker" data-v-7cb1dbce></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-7cb1dbce>页面导航</div><ul class="VPDocOutlineItem root" data-v-7cb1dbce data-v-0faef67b><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-de19328b></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-104e4e4a><div class="content-container" data-v-104e4e4a><!--[--><!--]--><main class="main" data-v-104e4e4a><div style="position:relative;" class="vp-doc _guide_modules_context" data-v-104e4e4a><div><h1 id="上下文" tabindex="-1">上下文 <a class="header-anchor" href="#上下文" aria-label="Permalink to &quot;上下文&quot;">​</a></h1><p><strong>上下文（Context）</strong> 是整个 Kotori 的核心机制，不仅是 Kotori 模块围绕着上下文实例实现一系列功能，即便是在 Kotori 内部也依赖于上下文实现各组件之间的通信与解耦合，同时也为 Kotori 的扩展提供了可能。犹如一个树根，Kotori 本身在内的各种内容均为其枝干，并通过不同的组合丰富枝干上枝叶的内容，上下文机制充分体现了**依赖注入（Dependency Injection）<strong>和</strong>面向切面编程（Aspect Oriented Programming）**的思想。</p><h2 id="注册与获取" tabindex="-1">注册与获取 <a class="header-anchor" href="#注册与获取" aria-label="Permalink to &quot;注册与获取&quot;">​</a></h2><p>上下文实例中包含诸多属性和方法，但绝大部分功能并非来源于上下文本身，而是来源于 Kotori 内部的其它组件。通过 <code>ctx.provide()</code> 可将指定对象注册到当前上下文实例中，并通过 <code>ctx.get()</code> 获取。</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">declare</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ctx</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">provide</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;config&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  port: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  host: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;localhost&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">provide</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;server&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">());</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ctx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;config&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// { port: 3000 }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> server</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ctx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;server&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Server {}</span></span></code></pre></div><p>无论是对象字面量还是实例对象，都可以作为上下文实例的提供者。请注意，此处所有对象均是直接引用并未进行深拷贝。</p><h2 id="注入与混合" tabindex="-1">注入与混合 <a class="header-anchor" href="#注入与混合" aria-label="Permalink to &quot;注入与混合&quot;">​</a></h2><p>使用 <code>ctx.inject()</code> 注入指定的已注册到当前上下文实例中的对象，注入后即可在上下文中通过注册名称直接获取到注入的实例，而无需再通过 <code>ctx.get()</code> 获取。</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">provide</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;config&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  port: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  host: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;localhost&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctx.config.port; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// TypeError: Cannot read properties of undefined (reading &#39;port&#39;)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;config&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctx.config.port; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 3000</span></span></code></pre></div><p>除了注入外，当只期望目标对象的部分属性或方法被装饰到上下文实例中时，可使用 <code>ctx.mixin()</code>。</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">provide</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;demo&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;hello, kotori!&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  display</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.name;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">display</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Uncaught TypeError: ctx.display is not a function</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mixin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;demo&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;display&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">display</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// hello, kotori!</span></span></code></pre></div><p>相比注入，混合更加颗粒化同时减去不必要的属性访问。无论是注入还是混合，都并非直接对对象进行复制或建立新引用，其通过代理控制对象的每个属性或方法的操作，以便解决在混合后，原对象中 this 指向等问题。</p><p>对于上面的演示代码，还可以进一步做一些对开发者友好的工作，凭借 TypeScript 中声明合并的特性，为开发者提供良好的代码补全提示。</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ctx</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  /* ... */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> demo</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  /* ... */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">declare</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> config;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  display</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> demo)[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;display&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">provide</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;demo&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, demo);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;config&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">provide</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;demo&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, config);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mixin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;demo&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;display&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]);</span></span></code></pre></div><h2 id="继承" tabindex="-1">继承 <a class="header-anchor" href="#继承" aria-label="Permalink to &quot;继承&quot;">​</a></h2><p>此外，通过代理得以实现父子级上下文的概念。如，Kotori 直接给与每个模块的执行主体的上下文实例均为独一无二，它是 Kotori 内部中根上下文实例的子级上下文实例，此外也有部分上下文实例是孙级上下文实例或更深。当访问上下文中的属性或方法时，若当前上下文实例中不存在，则会沿着继承链向上查找，直到根上下文为止，这点与 JavaScript 中原型链的查找方式类似，但原理不同。使用 <code>ctx.extends()</code> 继承当前上下文。</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ctx</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ctxChild1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ctx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">extends</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ctxChild2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ctx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">extends</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">provide</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;data1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { value: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;data1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctx.data1.value; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctxChild1.data1.value; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctxChild1.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">provide</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;data2&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { value: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctxChild1.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;data2&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctx.data2; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// undefined</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctxChild1.data2.value; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 2</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctxChild2.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">provide</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;data3&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { value: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctxChild2.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;data3&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctx.data3; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// undefined</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctxChild1.data3; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// undefined</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctxChild2.data3.value; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 3</span></span></code></pre></div><p>可见，上下文继承后具有相对隔离性，对于子级上下文来说，只能访问自己父级上下文中注册的对象（即便是在自己被继承后注册的），而不能访问非自己父级上下文和其它子级上下文中注册的对象。而父级上下文也只能往上获取，无法往下获取自己子级上下文单独注册的对象。</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ctx</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ctxChild1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ctx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">extends</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ctxChild2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ctx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">extends</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({meta: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;some meta data&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;child2&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctx.meta; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// undefined</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctxChild1.meta; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// undefined</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctxChild2.meta; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//&#39;some meta data&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctx.identity; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// undefined</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctxChild1.identity; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// &#39;sub&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctxChild2.identity; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// &#39;child2&#39;</span></span></code></pre></div><p>在继承时，可传入两个可选参数用于标记新的子级上下文实例，第一个参数类型为对象，作用效果类似于将对象注册后并将对象上所有属性执行 <code>ctx.mixin()</code>，但原理并不同，可用作传入一些子级上下文必要的元数据信息。第二个参数类型为字符串，为该子级上下文实例设置唯一标识符。对于根上下文实例而言，其标识符为 <code>undefined</code>，对于未设置标识符的子级上下文实例，其标识符为 <code>&#39;sub&#39;</code>。</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ctx</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ctxChild1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ctx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">extends</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ctxChild2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ctx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">extends</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ctxChild3</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ctxChild1.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">extends</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctx.root </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ctx; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctxChild1.root </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ctxChild1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ctxChild1.root </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ctxChild2; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// false</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctxChild1.root </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ctx </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ctxChild2.root </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ctx; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctxChild3.root </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ctxChild1; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// false</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctxChild3.root </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ctx; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// true</span></span></code></pre></div><p>通过 <code>ctx.root</code> 属性可获取当前上下文的根上下文实例，无论是子级上下文 <code>ctxChild1</code>、<code>ctxChild2</code>，还是继承了 <code>ctxChild1</code> 的孙级上下文 <code>ctxChild3</code>，其根上下文实例均指向 <code>ctx</code>，而根上下午实例的 <code>ctx.root</code> 指向自身。</p><h2 id="事件系统" tabindex="-1">事件系统 <a class="header-anchor" href="#事件系统" aria-label="Permalink to &quot;事件系统&quot;">​</a></h2><p>以上内容均由最初的 <code>Context</code> 类定义，通过类原生的继承方式和 <code>ctx.inject()</code>、<code>ctx.mixin()</code> 等方法对 <code>Context</code> 进行装饰或扩展。而在 <code>Context</code> 类内部，它本身就已为自己注册并注入了两个实例对象，其一便是事件系统，这也是在第二章中介绍事件系统时说道⌈事件订阅者模式与事件系统共同构成了 Kotori 的基础⌋的原由，只不过 <code>Context</code> 类本身并未使用事件系统功能，且仅直接定义了 <code>ready</code> 与 <code>dispose</code> 事件，两者被作为整个程序生命周期的重要一环，其余事件由另一实例对象（见下文）或 Kotori 核心类定义。</p><h2 id="插件系统" tabindex="-1">插件系统 <a class="header-anchor" href="#插件系统" aria-label="Permalink to &quot;插件系统&quot;">​</a></h2><p>其二便是插件系统，它定义了 <code>ready_module</code> 与 <code>dispose_module</code> 事件。在上一节说过⌈在真正学习到上下文之前，可暂且默认插件等同于模块⌋，而现在你将会对⌈插件⌋有更深的认知。</p><p>通过 <code>ctx.load()</code> 加载插件并触发 <code>ready_module</code> 事件，且 <code>ready_module</code> 事件在插件加载完毕后触发。</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* types */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ModuleInstanceClass</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ModuleConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ModuleInstanceFunction</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ModuleConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ModuleExport</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  main</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ModuleInstanceFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  Main</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ModuleInstanceClass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  default</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ModuleInstanceFunction</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ModuleInstanceClass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  inject</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[];</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ModuleConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> EventDataModule</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  instance</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ModuleExport</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ModuleInstanceFunction</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ModuleInstanceClass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* index.ts */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> plugin1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ctx.logger.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">debug</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;plugin1 loaded&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // output: module(main plugin) loaded</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ctx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;read_module&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> EventDataModule</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (data.instance </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> main) ctx.logger.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">debug</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;module(main plugin) loaded&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    else</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (data.instance </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> plugin1) ctx.logger.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">debug</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;plugin1(sub plugin) loaded&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ctx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">load</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(plugin1); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// output: plugin1(sub plugin) loaded</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><code>ctx.load()</code> 支持四种参数形式，最常用的是直接传入执行主体函数（<code>ModuleInstanceFunction</code>），此外也可以通过传入执行主体类（<code>ModuleInstanceClass</code>），亦或你想为子插件传入配置或注册依赖等也可使用导出对象形式（<code>ModuleExport</code>）：</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SubConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  port</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ctx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">load</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">private</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> subCtx</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ctx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">load</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    config: { port: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">subCtx</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">cfg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SubConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>导出对象形式与模块入口文件的导出是一致的。在 Kotori 内部，由加载器自动加载所有的模块入口文件进行预处理，然后转接给此处的 <code>ctx.load()</code> 进行调用执行主体。不同的是，此处可以定义 <code>name</code> 属性用于标记插件的名称，这将作用于该插件的上下文实例的 <code>ctx.identity</code> 中，而模块中的 <code>ctx.identity</code> 由加载器通过 <code>package.json</code> 中的包名自动获取。即便是子插件，它的上下文实例与配置数据也是完全独立，区别在于模块（由加载器加载）的上下文实例继承自 Kotori 内部中的根上下文实例，而子插件的上下文实例继承于当前模块的上下文实例，以此类推。入口文件中导出的 <code>config</code> 是一个配置检测者，加载器会调用它来验证 <code>kotori.yml</code> 中相应的实际配置数据是否符合要求，符合则将替换 <code>config</code> 为实际数据再传入 <code>ctx.load()</code> 作后续处理，在模块中执行 <code>ctx.load()</code>，其配置数据拥有确定性（指由开发者保证，与 Kotori 无关），因此要求此处直接传入配置数据。</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">plugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  my-project</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;here is a string&#39;</span></span></code></pre></div><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Tsu.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  value: Tsu.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">cfg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Tsu</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">infer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> config&gt;) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ctx.logger.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">debug</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx.identity, cfg.value); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// my-project here is a string</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> subCfg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    value: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">233</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ctx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">load</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;plugin1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">subCtx</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">cfg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> typeof</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 233</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      subCtx.logger.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">debug</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(subCtx.identity, cfg.value); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// plugin1 233</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>子插件与当前模块的上下文实例完全独立，具有隔离性，由此可通过这一点做一些需要隔离的操作：</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> inject</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [];</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ctx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">load</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;plugin1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    inject: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;database&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    main: (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">subCtx</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      /* ctx.database... */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ctx.logger.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">debug</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx.database) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// undefined</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>当然你也可以指定多个函数主体，这将会验证上一节所讲的执行主体的识别顺序，因此这只会执行其中一个：</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ctx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">load</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;plugin1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    inject: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;database&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    main: (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">subCtx</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      /* ctx.database... */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ctx.logger.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">debug</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx.database) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// undefined</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>加载一个依赖了 <code>database</code> 服务的子插件便可在其内部进行调用数据库操作，而在外层的模块中，并未依赖因此无法使用 <code>ctx.database</code> 属性。</p><p>此外，还有一项实验性功能，可直接将字符串（TypeScript/JavaScript 文件路径）作为参数传入 <code>ctx.load()</code>，但因其原本的加载文件功能被放置到加载器中实现，<code>ctx.load()</code> 仅会以同步形式直接调用执行主体，传入文件路径则会先动态加载文件，因此 <code>ctx.load()</code> 此时将变成一个异步函数。</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"></span></code></pre></div></div></div></main><footer class="VPDocFooter" data-v-104e4e4a data-v-b734292a><!--[--><!--]--><div class="edit-info" data-v-b734292a><div class="edit-link" data-v-b734292a><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://github.com/kotorijs/docs/edit/master/src/guide/modules/context.md" target="_blank" rel="noreferrer" data-v-b734292a><!--[--><span class="vpi-square-pen edit-link-icon" data-v-b734292a></span> 在 Github 上编辑此页面<!--]--></a></div><div class="last-updated" data-v-b734292a><p class="VPLastUpdated" data-v-b734292a data-v-f5d117e4>最后更新: <time datetime="2024-05-12T06:35:52.000Z" data-v-f5d117e4></time></p></div></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-b734292a><span class="visually-hidden" id="doc-footer-aria-label" data-v-b734292a>Pager</span><div class="pager" data-v-b734292a><a class="VPLink link pager-link prev" href="/guide/modules/plugin.html" data-v-b734292a><!--[--><span class="desc" data-v-b734292a>上一页</span><span class="title" data-v-b734292a>插件范式（Plugin）</span><!--]--></a></div><div class="pager" data-v-b734292a><a class="VPLink link pager-link next" href="/guide/modules/schema.html" data-v-b734292a><!--[--><span class="desc" data-v-b734292a>下一页</span><span class="title" data-v-b734292a>配置检测（Schema）</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-9e9cf943 data-v-7f874e69><div class="container" data-v-7f874e69><!----><p class="copyright" data-v-7f874e69>MIT Licensed | Copyright © 2023 - 2024 Hotaru</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"api_index.md\":\"BrbFCcT8\",\"basic_config.md\":\"B4pB_5Yi\",\"guide_components_custom.md\":\"Ddg3KHpz\",\"guide_index.md\":\"BiM12lJN\",\"guide_components_api.md\":\"rkK2Uz7j\",\"guide_components_adapter.md\":\"LE9Pp8Nb\",\"guide_modules_decorator.md\":\"DpQ3Fujp\",\"guide_start_publish.md\":\"CePS5H2s\",\"modules_index.md\":\"C1o3cur8\",\"guide_modules_i18n.md\":\"BPOlNL9h\",\"guide_base_regexp.md\":\"18xjpuo5\",\"guide_modules_service.md\":\"BQfZtEQe\",\"guide_extend_tools.md\":\"D5WkXL86\",\"guide_components_elements.md\":\"C74xxomA\",\"guide_base_middleware.md\":\"BU32LgnK\",\"index.md\":\"Bs0_bO7H\",\"guide_modules_schema.md\":\"CWnaFvZl\",\"basic_modules.md\":\"EPwtnx2z\",\"guide_modules_context.md\":\"DTI_fXSu\",\"guide_start_setup.md\":\"Bl5-qr1U\",\"guide_start_environment.md\":\"Do_m8-XT\",\"guide_base_command.md\":\"izi3_T8q\",\"basic_index.md\":\"B76NcoEB\",\"basic_usage.md\":\"BbvlQQYE\",\"guide_base_events.md\":\"B7dkjOxe\",\"guide_modules_plugin.md\":\"BrhNwGmw\",\"advanced_index.md\":\"D6hetWzP\",\"basic_start.md\":\"DANRDoZt\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Kotori\",\"description\":\"Cross-platform chatbot framework base on Node.js and TypeScript\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"logo\":\"/favicon.svg\",\"nav\":[{\"text\":\"入门\",\"link\":\"/basic/\"},{\"text\":\"开发\",\"link\":\"/guide/\"},{\"text\":\"接口\",\"link\":\"/api/\"},{\"text\":\"模块中心\",\"link\":\"/modules/\"},{\"text\":\"更新日志\",\"link\":\"https://github.com/kotorijs/kotori/blob/master/CHANGELOG.md\"}],\"sidebar\":{\"/basic/\":[{\"items\":[{\"text\":\"简介\",\"link\":\"/basic/\"}]},{\"text\":\"入门\",\"items\":[{\"text\":\"快速开始\",\"link\":\"/basic/start\"},{\"text\":\"模块安装\",\"link\":\"/basic/modules\"},{\"text\":\"配置详解\",\"link\":\"/basic/config\"}]},{\"items\":[{\"text\":\"立即使用\",\"link\":\"/basic/usage\"}]}],\"/guide/\":[{\"items\":[{\"text\":\"前言\",\"link\":\"/guide/\"}]},{\"text\":\"准备流程\",\"items\":[{\"text\":\"环境搭建\",\"link\":\"/guide/start/environment\"},{\"text\":\"项目构建\",\"link\":\"/guide/start/setup\"},{\"text\":\"模块发布\",\"link\":\"/guide/start/publish\"}]},{\"text\":\"基础设施\",\"items\":[{\"text\":\"事件系统（Events）\",\"link\":\"/guide/base/events\"},{\"text\":\"指令注册（Command）\",\"link\":\"/guide/base/command\"},{\"text\":\"中间件（Middleware）\",\"link\":\"/guide/base/middleware\"},{\"text\":\"正则匹配（RegExp）\",\"link\":\"/guide/base/regexp\"}]},{\"text\":\"模块化\",\"items\":[{\"text\":\"插件范式（Plugin）\",\"link\":\"/guide/modules/plugin\"},{\"text\":\"上下文（Context）\",\"link\":\"/guide/modules/context\"},{\"text\":\"配置检测（Schema）\",\"link\":\"/guide/modules/schema\"},{\"text\":\"国际化（i18n）\",\"link\":\"/guide/modules/i18n\"},{\"text\":\"服务依赖（Service）\",\"link\":\"/guide/modules/service\"}]},{\"text\":\"组件化\",\"items\":[{\"text\":\"实现元素类（Elements）\",\"link\":\"/guide/adapter/elements\"},{\"text\":\"实现接口类（Api）\",\"link\":\"/guide/adapter/api\"},{\"text\":\"实现适配器类（Adapter）\",\"link\":\"/guide/adapter/adapter\"},{\"text\":\"自定义服务（Service）\",\"link\":\"/guide/adapter/custom\"}]},{\"text\":\"扩展功能\",\"items\":[{\"text\":\"工具类\",\"link\":\"/guide/extend/tools\"}]}]},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/kotorijs/kotori\"}],\"footer\":{\"copyright\":\"MIT Licensed | Copyright © 2023 - 2024 Hotaru\"},\"editLink\":{\"pattern\":\"https://github.com/kotorijs/docs/edit/master/src/:path\",\"text\":\"在 Github 上编辑此页面\"},\"lastUpdated\":{\"text\":\"最后更新\",\"formatOptions\":{\"dateStyle\":\"full\",\"timeStyle\":\"medium\"}},\"docFooter\":{\"prev\":\"上一页\",\"next\":\"下一页\"},\"outline\":{\"label\":\"页面导航\"},\"darkModeSwitchLabel\":\"主题\",\"lightModeSwitchTitle\":\"切换到浅色模式\",\"darkModeSwitchTitle\":\"切换到深色模式\",\"sidebarMenuLabel\":\"菜单\",\"returnToTopLabel\":\"返回顶部\"},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>